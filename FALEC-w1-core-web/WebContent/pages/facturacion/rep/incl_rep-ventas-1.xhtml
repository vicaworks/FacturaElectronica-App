<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		
		.pvUnoDT .ui-datatable-scrollable-body{
			min-height: 35vh !important;
			
		}
		
	</style>
	
	<div class="card card-w-title">
		<div class="p-grid p-justify-between p-align-center">
			<div class="p-col-12 p-md-6">
				<h3 class="cardTitle">
					<i class="fa fa-arrow-circle-right"/>
					Opciones de #{msg['label.busqueda.lower']} globales
				</h3>
			</div>
			
			<div class="p-col-12 p-md-6 cmb_establecimiento" style="text-align: right;">
				<h:outputText value="Establecimiento * : " style="margin-right:5px;"/>
				<p:selectOneMenu id="somEstablecimientoMain"
					value="#{repMainCtrl.establecimientoMain}"
					converter="omnifaces.SelectItemsConverter"
					styleClass="cmb_establecimiento_wrapper"
					disabled="#{not repMainCtrl.habilitarEstablecimientoMain}">
					
					<f:selectItem itemLabel="ESTABLECIMIENTO - TODOS" itemValue="#{null}"/>
					
					<f:selectItems value="#{repMainCtrl.establecimientoMainList}" var="st"
						itemLabel="#{st.nombrecomercial.concat(' - ').concat(appSessionCtrl.formatoCadena(st.codigoestablecimiento,3,'0'))}" itemValue="#{st}" />
					
					<p:ajax event="valueChange" update=":formMain :formMain2 :formMain3 :formMain4 :formMain5" process=":formMain :formMain2 :formMain3 :formMain4 :formMain5"
						listener="#{repMainCtrl.consultarMain(repVentaCtrl,repFacCtrl,repFacAnuCtrl,repRecibCtrl,repRecibAnuCtrl)}">
					</p:ajax>
							
				</p:selectOneMenu>
				
			</div>
			
		</div>
   		<div class="EmptyBox5"/>
    	<div class="p-grid p-align-center vertical-container">
    	
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="VENDEDOR *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
    			<p:selectOneMenu id="somVendedor"
							value="#{repVentaCtrl.usuarioSelected}"
							converter="omnifaces.SelectItemsConverter"
							required="false"
							requiredMessage="REQUERIDO"
							styleClass="Wid100"
							filter="true"
							filterMatchMode="contains">
					<f:selectItem itemLabel="TODOS" itemValue="#{null}"/>
					<f:selectItems value="#{repVentaCtrl.usuarioList}" var="u"
									itemLabel="#{u.nombre}" itemValue="#{u}" />	
				</p:selectOneMenu>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="TIPO PAGO *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
    			<p:selectOneMenu id="somTipoPago"
							value="#{repVentaCtrl.tipopagoSelected}"
							converter="omnifaces.SelectItemsConverter"
							required="false"
							requiredMessage="REQUERIDO"
							styleClass="Wid100"
							filter="true"
							filterMatchMode="contains">
					<f:selectItem itemLabel="TODOS" itemValue="#{null}"/>
					<f:selectItems value="#{repVentaCtrl.tipopagoList}" var="tp"
									itemLabel="#{tp.nombre}" itemValue="#{tp}" />	
				</p:selectOneMenu>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="FABRICANTE *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
    			<p:selectOneMenu id="somFabricante"
							value="#{repVentaCtrl.fabricanteSelected}"
							converter="omnifaces.SelectItemsConverter"
							required="false"
							requiredMessage="REQUERIDO"
							styleClass="Wid100"
							filter="true"
							filterMatchMode="contains">
					<f:selectItem itemLabel="TODOS" itemValue="#{null}"/>
					<f:selectItems value="#{repVentaCtrl.fabricanteList}" var="fa"
									itemLabel="#{fa.nombrecomercial}" itemValue="#{fa}" />	
				</p:selectOneMenu>
    		</div>
    		 
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="#{msg['label.categoria']} *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
    			<p:selectOneMenu id="somCategoria"
							value="#{repVentaCtrl.categoriaSelected}"
							converter="omnifaces.SelectItemsConverter"
							required="false"
							requiredMessage="REQUERIDO"
							styleClass="Wid100"
							filter="true"
							filterMatchMode="contains">
					<f:selectItem itemLabel="TODOS" itemValue="#{null}"/>
					<f:selectItems value="#{repVentaCtrl.categoriaList}" var="ca"
									itemLabel="#{ca.categoria}" itemValue="#{ca}" />	
				</p:selectOneMenu>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="CRITERIO" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
    			<p:inputText value="#{repVentaCtrl.criterioBusqueda}" placeholder="#Factura, Cliente, Cod barra, producto" styleClass="Wid100"/>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="DESDE *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
	    		<p:calendar id="calRep1" value="#{repVentaCtrl.desde}"
					pattern="dd/MM/yyyy"
					locale="es" 
					requiredMessage="REQUERIDO" required="true" styleClass="Wid100 Fs14" placeholder="dd/MM/yyyy">
				</p:calendar>
				<p:message for="calRep1"/>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="HASTA *" styleClass="cpoRequerido Wid100"/>
    			<div class="EmptyBox5"/>
	    		<p:calendar id="calRep2" value="#{repVentaCtrl.hasta}"
					pattern="dd/MM/yyyy"
					locale="es" 
					requiredMessage="REQUERIDO" required="true" styleClass="Wid100 Fs14" placeholder="dd/MM/yyyy">
				</p:calendar>
				<p:message for="calRep2"/>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    		
  					<div class="EmptyBox5"/>
  					<p:commandButton id="cmdGlobalBuscar"
						icon="fa fa-search" 
						action="#{repVentaCtrl.buscar()}" styleClass="secondary-button Fs18" update="@form" style="margin-right:5px;">
						<f:setPropertyActionListener value="#{repMainCtrl.establecimientoMain}" target="#{repVentaCtrl.establecimientoMain}"/>
					</p:commandButton>
					
  					<p:commandButton id="cmdGlobalExcel"
						icon="fa fa-file-excel-o" 
						styleClass="success-btn Fs18"
						ajax="false" onclick="PrimeFaces.monitorDownload(start,stop)">
						<p:fileDownload value="#{repVentaCtrl.file}"/>
					</p:commandButton>
					
    		</div>
    		
    	</div>
    	
    	<div class="EmptyBox5"/>
    	<p:dataTable id="pvUnoDT"
       			scrollable="true"
       			value="#{repVentaCtrl.ventasQueryList}"
       			var="v"
       			emptyMessage="#{msg['mensaje.noexistenDatos']}"
				styleClass="pvUnoDT Fs10"
				rows="13"
                paginator="true"
                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                paginatorPosition="bottom"  
				rowKey="#{v.id}">
			
			<p:column headerText="N." style="width:80px;">
				<h:outputText value="#{repVentaCtrl.getFormatoNumDocumento(v.numdocumento)}" />
			</p:column>
			
			<p:column headerText="TIP" style="width:15px;">
				<h:outputText value="#{v.tipoComprobanteInicual}" style="font-size:8px;" styleClass="#{v.identificador=='00'?'markGray':'markGreen'}">
				</h:outputText>
			</p:column>
			
			<p:column headerText="FECHA" style="width:50px;">
				<h:outputText value="#{v.fechaemision}" >
					<f:convertDateTime pattern="dd/MM/yyyy"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="CLIENTE" style="width:125px;">
				<h:outputText value="#{v.razonsocial}" />
			</p:column>
			
			<p:column headerText="PRODUCTO" style="width:120px;">
				<h:outputText value="#{v.descripcion}" />
			</p:column>
			
			<p:column headerText="CANT" style="width:30px;" styleClass="TexAlRight">
				<h:outputText value="#{v.cantidad}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoNumberDecimalOpcional}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="PRE VTA" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.preciounitario}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="SUBTOT" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.subtotal}" styleClass="markGray">
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="DESC" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.totaldescuento}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="TOT SIN IVA" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.totalsinimpuestos}" styleClass="markGreen">
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="ICE" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.valorice}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="IVA" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.valoriva}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			
			<p:column headerText="TOTAL" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{v.preciototal}" styleClass="markGreen">
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
						
		</p:dataTable>
    	
    	<div class="EmptyBox5"/>
    	<div class="p-grid p-justify-center">
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="CANTIDAD" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.cantidad}" styleClass="Fs16 FontBold">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoNumberDecimalOpcional}"/>
    			</h:outputText>
    		</div>
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="SUBTOTAL" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.subtotal}" styleClass="Fs16 FontBold">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoMoneda}"/>
    			</h:outputText>
    		</div>
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="DESCUENTO" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.descuento}" styleClass="Fs16 FontBold">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoMoneda}"/>
    			</h:outputText>
    		</div>
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="TOTAL SIN IVA" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.totalsinimpuestos}" styleClass="Fs16 FontBold markGreen">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoMoneda}"/>
    			</h:outputText>
    		</div>
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="IVA" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.iva}" styleClass="Fs16 FontBold">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoMoneda}"/>
    			</h:outputText>
    		</div>
    		<div class="p-col-4 p-md-2" style="text-align: center;">
    			<h:outputText value="TOTAL" styleClass="FontBold Fs9 DispBlock" style="color:gray;margin-bottom:5px;"/>
    			<h:outputText value="#{repVentaCtrl.totalesDto.total}" styleClass="Fs16 FontBold  markGreen">
    				<f:convertNumber  pattern="#{appSessionCtrl.formatoMoneda}"/>
    			</h:outputText>
    		</div>
    	</div>
    	
	</div>	
	
</ui:composition>
