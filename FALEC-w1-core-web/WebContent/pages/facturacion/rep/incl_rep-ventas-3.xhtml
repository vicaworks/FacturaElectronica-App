<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		
		.pvtresDT .ui-datatable-scrollable-body{
			min-height: 35vh !important;
		}
		
	</style>
	
	<div class="card card-w-title">
	
		<span class="block text-3xl mb-2 fw-5">Facturas anuladas</span>
				
		<div class="grid ui-fluid main__opciones px-2">
			
			<div class="col-12 md:col-4">
				<div class="field">
					<label class="text-gray-800">Fechas</label>
					<div class="flex gap-2">
						<p:calendar id="calRep5" value="#{repFacAnuCtrl.desde}"
							pattern="dd/MM/yyyy"
							locale="es" 
							requiredMessage="Requerido" required="true" placeholder="dd/MM/yyyy">
						</p:calendar>
						<p:calendar id="calRep6" value="#{repFacAnuCtrl.hasta}"
							pattern="dd/MM/yyyy"
							locale="es" 
							requiredMessage="Requerido" required="true" placeholder="dd/MM/yyyy">
						</p:calendar>
						
					</div>
				</div>
			</div>
			
			<div class="col-12 md:col-4">
				<div class="field">
					<label class="text-gray-800">Vendedor</label>
					<p:selectOneMenu id="somVendedorRep2"
							value="#{repFacAnuCtrl.usuarioSelected}"
							converter="omnifaces.SelectItemsConverter"
							required="false"
							requiredMessage="Requerido"
							styleClass="overflow-x-hidden"
							style="width: calc(100% - 0.1rem)">
						<f:selectItem itemLabel="Todos" itemValue="#{null}"/>
						<f:selectItems value="#{repFacAnuCtrl.usuarioList}" var="u2"
										itemLabel="#{u2.nombre}" itemValue="#{u2}" />	
					</p:selectOneMenu>
				</div>
			</div>
			
			<div class="col-12 md:col-4">
				<div class="field">
					<label class="text-gray-800">Criterio de búsqueda</label>
					<p:inputText value="#{repFacAnuCtrl.criterioBusqueda}" placeholder="#Factura, Idenfificación cliente"/>
				</div>
			</div>
		
		</div>
		
		<div class="flex justify-content-between my-2">
			<div class="flex gap-2">
				<p:commandButton icon="fa fa-search" 
					value="Buscar"
					action="#{repFacAnuCtrl.buscar()}" 
					styleClass="ui-button-success" 
					update="@form">
					<f:setPropertyActionListener value="#{repMainCtrl.establecimientoMain}" target="#{repFacAnuCtrl.establecimientoMain}"/>
				</p:commandButton>
					
				<p:commandButton icon="fa fa-download" 
					styleClass="ui-button-outlined" 
					update="@form"
					ajax="false" 
					onclick="PrimeFaces.monitorDownload(start,stop)">
					<p:fileDownload value="#{repFacAnuCtrl.file}"/>
				</p:commandButton>
			</div>
		</div>		
		
    	<p:dataTable id="pvtresDT"
       			scrollable="true"
       			value="#{repFacAnuCtrl.ventasQueryList}"
       			var="fn"
       			emptyMessage="#{msg['mensaje.noexistenDatos']}"
				styleClass="pvtresDT mt-1"  
				rowKey="#{fn.id}"
				rows="13"
                paginator="true"
                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                paginatorPosition="bottom">
				
				
				<p:column headerText="Comprobante" style="width:150px;">
					<div class="flex gap-1 justify-content-between align-items-baseline">
						<h:outputText value="#{fn.tipoComprobante}" styleClass="text-gray-800 fw-5">
						</h:outputText>
						<h:outputText value="#{fn.fechaemision}" styleClass="text-gray-800 fw-5">
							<f:convertDateTime pattern="dd/MM/yyyy"/>
						</h:outputText>
					</div>
					<div class="flex gap-1 justify-content-between align-items-baseline">
						<h:outputText value="#{repFacAnuCtrl.getFormatoNumDocumento(fn.numdocumento)}" styleClass="fs-12 text-primary-600"/>
					</div>
				</p:column>
				
				<p:column headerText="Vendedor" style="width:120px;">
					<h:outputText value="#{fn.nombrepantalla}" styleClass="text-gray-900">
					</h:outputText>
				</p:column>
				
				<p:column headerText="Cliente" style="width:150px;">
					<div class="flex gap-1 justify-content-between align-items-baseline">
						<h:outputText value="#{fn.identificacion}" styleClass="text-gray-800 fw-5"/>
					</div>
					<div class="flex gap-1 justify-content-between align-items-baseline">
						<h:outputText value="#{fn.razonsocial}" styleClass="fs-12 text-primary-600 fw-5"/>
					</div>
				</p:column>
				
				<p:column style="width:80px;" styleClass="text-center">
					<f:facet name="header">
						<div class="flex flex-column">
							<span class="block">Valor</span>
						</div>
					</f:facet>
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.subtotal}" styleClass="#{fn.subtotal.doubleValue() > 0.0? 'text-gray-900':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
				
				<p:column headerText="Desc" style="width:80px;" styleClass="text-center">
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.totaldescuento}" styleClass="#{fn.subtotal.doubleValue() > 0.0? 'text-gray-800':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
				
				<p:column style="width:80px;" styleClass="text-center">
					<f:facet name="header">
						<div class="flex flex-column">
							<span class="block">Sin impuestos</span>
						</div>
					</f:facet>
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.totalsinimpuestos}" styleClass="#{fn.totalsinimpuestos.doubleValue() > 0.0 ? 'text-gray-800 fw-5':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
				
				<p:column headerText="ICE" style="width:80px;" styleClass="text-center">
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.ice}" styleClass="#{fn.ice.doubleValue() > 0.0 ? 'text-gray-900':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
				
				<p:column headerText="IVA" style="width:80px;" styleClass="text-center">
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.iva}" styleClass="#{fn.iva.doubleValue() > 0.0 ? 'text-gray-900':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
				
				<p:column headerText="Total" style="width:100px;" styleClass="text-center">
					<div class="flex justify-content-end">
						<h:outputText value="#{fn.total}" styleClass="#{fn.total.doubleValue() > 0.0 ? 'text-blue-800 fw-5':'opacity-50'}">
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</p:column>
						
		</p:dataTable>
		
		
		<div class="grid justify-content-end">
			<div class="col-12 md:col-5">
				<div class="grid grid-nogutter justify-content-between">
					<div class="col-7 py-2">
						<div class="w-full text-left">
							<span class="fs-10 mr-1 text-gray-700 font-semibold">TOTAL</span>
							<span class="fs-14 text-blue-600 font-medium">RESUMEN</span>
						</div>
					</div>
					<div class="col-1 text-center align-self-center">
						<i class="fa fa-angle-down fs-14"></i>
					</div>
					<div class="col-12 mt-1">
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="Cantidad" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.cantidad}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoInteger}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
						
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="Subtotal" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.subtotal}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
						
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="Descuento" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.descuento}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
						
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="Sin impuestos" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.totalsinimpuestos}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
						
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="I.V.A" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.iva}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
						
						<div class="flex mt-1 border-bottom-1 border-blue-100 py-2">
							<div class="flex flex-grow-1 fs-11">
								<i class="fa fa-angle-right mr-1 font-bold"></i>
								<span class="text-gray-800"><h:outputText value="Total" /></span>
							</div>						
							<div class="flex flex-grow-1">
								<div class="text-right pr-3 w-full fs-14">
									<h:outputText value="#{repFacAnuCtrl.totalesDto.total}">
										<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
									</h:outputText>
								</div>
							</div>				
						</div>
					</div>
				</div>
			</div>
		</div>
		   	
	</div>	
	
</ui:composition>
