<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		
		.heightFrmDestinatario {
				/* height: 550px; */
		}	
		
	</style>
	
	<p:dialog 
		header="Destinatario" 
		widgetVar="dlgDestinatario" 
		modal="true" 
		responsive="true" 
		width="99%"
		style="max-width:500px;" 
		closeOnEscape="true" 
		styleClass="modalResponsivo">
	
		
		<h:form id="frmDestinatario">
			
			
			<!-- OPCIONES -->
			
			<div class="tool-bar">
				<i class="fa-solid fa-ellipsis-vertical"></i>
				
				<p:commandButton id="cmdGuardarTransportista"
					value="Continuar" icon="fa fa-check" 
					action="#{guiaRemFormCtrl.guardarDestinatario()}" 
					styleClass="min-width-100 ui-button-success" 
					update="@form :formMain" 
					rendered="#{guiaRemFormCtrl.callModule=='GUIA_REMISION'}">
				</p:commandButton>
				
				<p:commandButton id="cmdGuardarTransportista2"
					value="Continuar" icon="fa fa-check" 
					action="#{guiaRemFormCtrl.guardarDestinatarioByOtros()}" 
					styleClass="min-width-100 ui-button-success" 
					update="@form :formMain" 
					rendered="#{guiaRemFormCtrl.callModule=='FACTURA'}">
				</p:commandButton>
					
					
				<p:commandButton id="cmdCerrar"
					value="Cerrar" 
					icon="fa fa-sign-out" styleClass="min-width-100 ui-button-outlined ui-button-secondary" 
					onclick="PF('dlgDestinatario').hide()" immediate="true"/>
				
			</div>
			
			<div class="w-full overflow-auto heightFrmDestinatario contenedorFormulario mt-2 pr-1 ui-fluid fs-12">
				
				
				<div style="width: 99.5%!important;">
					
				    <div class="field">
				        <label class="text-gray-800 fw-5">Destinatario</label>
				        <div class="flex">
							<div class="flex-grow-1 flex overflow-hidden">
								<div class="ui-inputgroup w-full">
				                    <p:inputText id="inpCriterioCliente"
										value="#{guiaRemFormCtrl.criterioCliente}" required="false"
										requiredMessage="REQUERIDO" styleClass="w-full fs-12"
										maxlength="13" placeholder="C.I. o RUC / ENTER PARA BUSCAR"
										validatorMessage="SOLO NUMEROS"
										onkeydown="if(event.keyCode==13){event.keyCode=123; return false;}">
										<f:validateRegex pattern="^\d+$" />	
									</p:inputText>
				                    <p:commandButton icon="pi pi-search" styleClass="ui-button-success" 
				                    	process="@this :frmDestinatario:inpCriterioCliente"
				                    	update="@this :frmDestinatario:gridCliente :frmDestinatario:intGrDestDestinao"
										action="#{guiaRemFormCtrl.buscarCliente()}">
									</p:commandButton>
				                </div>
							</div>
							<div class="flex-grow-0 flex align-items-center px-1">
								<p:commandLink action="#{clienteCtrl.nuevoEditar(guiaRemFormCtrl.destinatarioSelected.cliente!=null?guiaRemFormCtrl.destinatarioSelected.cliente.idcliente:null)}" process="@this" styleClass="ml-1 mr-2 text-gray-900">
									<i class="fa fa-file fs-16"></i>
									<f:setPropertyActionListener value="guiaRemFormCtrl" target="#{clienteCtrl.callModule}"/>
									<f:setPropertyActionListener value=" :frmDestinatario:gridCliente :frmDestinatario:intGrDestDestinao" target="#{clienteCtrl.updateView}"/>
									<f:setPropertyActionListener value="#{null}" target="#{clienteCtrl.clienteSelected}"/>
								</p:commandLink>								
								<p:commandLink action="#{clienteCtrl.nuevoEditar(guiaRemFormCtrl.destinatarioSelected.cliente!=null?guiaRemFormCtrl.destinatarioSelected.cliente.idcliente:null)}" process="@this" styleClass="text-gray-900">
									<i class="fa fa-edit fs-16"></i>
									<f:setPropertyActionListener value="guiaRemFormCtrl" target="#{clienteCtrl.callModule}"/>
									<f:setPropertyActionListener value=" :frmDestinatario:gridCliente :frmDestinatario:intGrDestDestinao" target="#{clienteCtrl.updateView}"/>
									<f:setPropertyActionListener value="#{null}" target="#{clienteCtrl.clienteSelected}"/>
								</p:commandLink>
							</div>
						</div>
				    </div>
				    
				    <p:outputPanel id="gridCliente" styleClass="my-1 flex " style="height:9rem;">
						<p:skeleton height="9rem" rendered="#{guiaRemFormCtrl.destinatarioSelected==null}"/>
						<f:subview rendered="#{guiaRemFormCtrl.destinatarioSelected!=null}">
							<div class="flex flex-column gap-1">
								<span class="fs-16 font-bold text-primary-600 font-semibold">
									<h:outputText value="#{guiaRemFormCtrl.destinatarioSelected.razonsocialdestinatario!=null?guiaRemFormCtrl.destinatarioSelected.razonsocialdestinatario:'-'}" />
								</span>
								<span class="fs-12 text-gray-800 fw-5">
									<h:outputText value="#{guiaRemFormCtrl.destinatarioSelected.identificaciondestinatario!=null?guiaRemFormCtrl.destinatarioSelected.identificaciondestinatario:'-'}" />
								</span>
								<span class="fs-12 text-gray-900">
									<h:outputText value="#{guiaRemFormCtrl.destinatarioSelected.dirdestinatario!=null?guiaRemFormCtrl.destinatarioSelected.dirdestinatario:'-'}" />
								</span>
								<div class="flex gap-2 fs-11">
									<i class="pi pi-phone"></i>
									<h:outputText value="-" />
								</div>
								<div class="flex gap-2 fs-11">
									<i class="fa-regular fa-envelope"></i>
									<h:outputText value="-" />
								</div>
							</div>
						</f:subview>
					</p:outputPanel>
				    
				    <div class="field">
				        <label class="text-gray-800 fw-5">Destino dirección</label>
						<p:inputTextarea id="intGrDestDestinao" value="#{guiaRemFormCtrl.destinatarioSelected.dirdestinatario}" maxlength="300" required="true" requiredMessage="Requerido" rows="2">
						</p:inputTextarea>
				    </div>
				    
				    <div class="field">
				        <label class="text-gray-800 fw-5">Motivo de traslado</label>
						<p:inputTextarea id="intGrDestMotTraslado" value="#{guiaRemFormCtrl.destinatarioSelected.motivotraslado}" maxlength="300" required="true" requiredMessage="Requerido" rows="2">
						</p:inputTextarea>
				    </div>
				    
				    <div class="field">
				        <label class="text-gray-800 ">Código establecimiento de destino</label>
						<p:inputText id="intGrDestEstDestino" value="#{guiaRemFormCtrl.destinatarioSelected.codestabdestino}" maxlength="3" required="false" requiredMessage="Requerido">
						</p:inputText>
				    </div>
				    
				    <div class="field">
				        <label class="text-gray-800 fw-5">Documento de sustento</label>
						<p:selectOneMenu id="somGrTipComprobante"
									value="#{guiaRemFormCtrl.destinatarioSelected.tipocomprobante}"
									converter="omnifaces.SelectItemsConverter"
									required="false"
									requiredMessage="Requerido"
									styleClass="overflow-x-hidden"
									style="width: calc(100% - 0.1rem)"
									filter="true" 
									filterMatchMode="contains">
									
							<f:selectItem itemLabel="Seleccionar ..."
									itemValue="#{null}" value="#{null}" noSelectionOption="true" />
	
							<f:selectItems value="#{guiaRemFormCtrl.tipocomprobanteList}" var="tp"
								itemLabel="#{tp.comprobante}" itemValue="#{tp}" />
								
						</p:selectOneMenu>
				    </div>
				    
				    <div class="flex">
						<div class="field flex-grow-1">
							<label class="text-gray-800 fw-5">Fecha de emisión</label>
							<p:calendar id="claGrFechaEmision" value="#{guiaRemFormCtrl.destinatarioSelected.fechaemisiondocsustento}"
								pattern="dd/MM/yyyy"
								requiredMessage="REQUERIDO" required="false" styleClass="Wid100">
							</p:calendar>
						</div>
						
						<div class="field flex-grow-1">
							<label class="text-gray-800 fw-5">Número de documento</label>
							<p:inputMask id="intGrDestNumDocAsociado"
									mask="999-999-999999999"
									value="#{guiaRemFormCtrl.destinatarioSelected.numdocsustento}" required="false"
									requiredMessage="Requerido"
									maxlength="17" placeholder="000-000-000000000"
									onkeydown="if(event.keyCode==13){event.keyCode=123; return false;}">
									<f:converter converterId="formatoNumComprobanteConverter"/>
							</p:inputMask>
						</div>
					</div>
				    
				    <div class="field flex-grow-1">
						<label class="text-gray-800">Número de autorización</label>
						<p:inputText id="intGrDestAutDocAduanero" value="#{guiaRemFormCtrl.destinatarioSelected.numautdocsustento}" maxlength="49" required="false" requiredMessage="Requerido">
						</p:inputText>
					</div>
					
					<div class="field flex-grow-1">
						<label class="text-gray-800">Ruta</label>
						<p:inputText id="intGrDestRuta" value="#{guiaRemFormCtrl.destinatarioSelected.ruta}" maxlength="300" required="false" requiredMessage="Requerido">
						</p:inputText>
					</div>
					
					<div class="field flex-grow-1">
						<label class="text-gray-800">Documento aduanero único</label>
						<p:inputText id="intGrDestDocAduanero" value="#{guiaRemFormCtrl.destinatarioSelected.docaduanerounico}" maxlength="20" required="false" requiredMessage="REQUERIDO" styleClass="Wid100">
						</p:inputText>
					</div>
					
				</div>
				
			</div>
		
		</h:form>
	
	</p:dialog>
	
</ui:composition>
