<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		
		.heightFrmKdxEntrada {
				height: 300px;
		}
		
	</style>
	
	<p:dialog header="Entrada de inventario" widgetVar="dlgEntradaInventario" modal="true" responsive="true" width="99%" style="max-width:50rem;" closeOnEscape="true" styleClass="modalResponsivo">
		
		<h:form id="frmKardex">
			
			<!-- OPCIONES -->
			
			<div class="tool-bar">
				<i class="fa-solid fa-ellipsis-vertical"></i>
				<p:commandButton id="cmdKrxEntradaGuardar"
					value="Guardar" icon="fa-regular fa-floppy-disk fs-13" 
					action="#{kardexCtrl.guardar()}" 
					styleClass="min-width-100 ui-button-success fs-13" 
					update="@form #{kardexCtrl.updateView}"
					/>
					
				<p:commandButton id="cmdKrxEntradaCerrar"
					value="Cerrar" styleClass="min-width-100 ui-button-outlined ui-button-secondary fs-13" 
					onclick="PF('dlgEntradaInventario').hide()" immediate="true"  
					/>
			</div>
			
			<p:messages rendered="#{not facesContext.validationFailed}" showSummary="true" showDetail="true" for="frmKardex"
				closable="true" >
				<p:autoUpdate></p:autoUpdate>
			</p:messages>
			<p:message for="claKardexFechaFabricacion_Val" closable="true">
				<p:autoUpdate></p:autoUpdate>
			</p:message>
			<p:message for="claKardexFechaCompFechRegistro_Val" closable="true">
				<p:autoUpdate></p:autoUpdate>
			</p:message>
			
			<!--  wraper del formulario para responsive -->
			
			<div class="w-full overflow-auto heightFrmKdxEntrada contenedorFormulario mt-2 pr-1 ui-fluid">
				
				<o:validateMultiple id="claKardexFechaFabricacion_Val" 
					components="claKardexFechaCompra claKardexFechaFabricacion" 
					validator="#{validatorDateBeforeThan}" 
        			message="Fecha de fabricaci贸n no puede ser mayor a la fecha de compra." />
        		<o:validateMultiple id="claKardexFechaCompFechRegistro_Val" 
        			components="claKardexFechaRegistro claKardexFechaCompra" 
        			validator="#{validatorDateBeforeThan}" 
        			message="Fecha de compra no puede ser mayor a la fecha de registro" />
        		
				
				<div class="field">
					<label class="text-gray-800 fw-5">Establecimiento</label>
					<p:inputText readonly="true"
						value="#{appSessionCtrl.formatoCadena(kardexCtrl.establecimientoMain.codigoestablecimiento,3,'0')}">
					</p:inputText>
			    </div>
			    
			    <div class="field">
					<label class="text-gray-800 fw-5">Producto</label>
					<p:inputText readonly="true"
						value="#{kardexCtrl.productoSelected.nombregenerico}">
					</p:inputText>
			    </div>
			    
			    <div class="flex gap-2">
			    	<div class="field">
						<label class="text-gray-900">Id Producto</label>
						<p:inputText readonly="true"
							value="#{kardexCtrl.productoSelected.idproducto}">
						</p:inputText>
				    </div>
				    <div class="field">
						<label class="text-gray-900">C贸digo interno</label>
						<p:inputText readonly="true"
							value="#{kardexCtrl.productoSelected.codigoauxiliar}">
						</p:inputText>
				    </div>
				    <div class="field">
						<label class="text-gray-900">Cod barra</label>
						<p:inputText readonly="true"
							value="#{kardexCtrl.productoSelected.codigoprincipal}">
						</p:inputText>
				    </div>
			    </div>
			    
			    <div class="flex gap-2">
			    	<div class="field flex-1">
						<label class="text-gray-900 fw-5">Fecha de registro</label>
						<p:calendar id="claKardexFechaRegistro" value="#{kardexCtrl.kardexProductoSelected.fecharegistro}"
										pattern="dd/MM/yyyy"
										locale="es" 
										requiredMessage="Requerido" required="true">
						</p:calendar>
				    </div>
				    
				    <div class="field flex-1">
						<label class="text-gray-800 fw-5">Fecha de compra</label>
						<p:calendar id="claKardexFechaCompra" value="#{kardexCtrl.kardexProductoSelected.fechacompra}"
										pattern="dd/MM/yyyy"
										locale="es" 
										requiredMessage="Requerido" required="true">
						</p:calendar>
				    </div>
				    
				</div>
				
				<div class="flex gap-2">
			    	<div class="field flex-1">
						<label class="text-gray-900">Fecha de fabricaci贸n</label>
						<p:calendar id="claKardexFechaFabricacion" value="#{kardexCtrl.kardexProductoSelected.fechafabricacion}"
							pattern="dd/MM/yyyy"
							locale="es" 
							requiredMessage="Requerido" required="false">
						</p:calendar>
				    </div>
				    
				    <div class="field flex-1">
						<label class="text-gray-900">Fecha de vencimiento</label>
						<p:calendar id="claKardexFechaVencimiento" value="#{kardexCtrl.kardexProductoSelected.fechavencimiento}"
							pattern="dd/MM/yyyy"
							locale="es" 
							requiredMessage="Requerido" required="false">
						</p:calendar>
				    </div>
				    
				</div>
				
				<div class="flex gap-2">
			    	<div class="field flex-1">
			    		<label class="text-gray-800 fw-5">Stock actual</label>
			    		<p:inputText readonly="true" 
			    			value="#{kardexCtrl.productoSelected.stock}" 
			    			styleClass="text-right fs-18"/>
			    	</div>
			    	<div class="field flex-1">
			    		<label class="text-gray-800 fw-5">Cantidad de entrada</label>
			    		<p:inputText id="intKardexCantidad"
							value="#{kardexCtrl.kardexProductoSelected.cantidad}"
							required="true" requiredMessage="Requerido"
							styleClass="text-right fs-18" converterMessage="#{msg['converter.solonumeros']}" validatorMessage="Valor > 0">
							<f:convertNumber pattern="0.##"/>
							<f:validateDoubleRange minimum="0.1"/>
						</p:inputText>
						<p:message for="intKardexCantidad" styleClass="block p-0 m-0"/>
			    	</div>
			    	<div class="field flex-1">
			    		<label class="text-gray-800 fw-5">Precio compra</label>
			    		<p:inputText id="intKardexCostoUnitario"
							value="#{kardexCtrl.kardexProductoSelected.costounitario}"
							required="true" requiredMessage="Requerido"
							styleClass="text-right fs-18" 
							converterMessage="#{msg['converter.solonumeros']}" validatorMessage="Valor > 0">
							<f:convertNumber pattern="0.##"/>
							<f:validateDoubleRange minimum="0.01" />
						</p:inputText>
						<p:message for="intKardexCostoUnitario" styleClass="block p-0 m-0"/>
			    	</div>
			    </div>
			    
			    <div class="field">					
					<label class="text-gray-800 fw-5">Observaci贸n</label>
					<p:inputTextarea id="intKardexObservacion"
						value="#{kardexCtrl.kardexProductoSelected.observacion}"
						required="true" requiredMessage="Requerido"
						maxlength="800" converter="omnifaces.ToUpperCaseConverter"
						rows="3" 
						styleClass="fs-13"/>
			    </div>
			    
			</div>			
		</h:form>		
   </p:dialog>      

</ui:composition>
