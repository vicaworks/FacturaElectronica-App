<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="title">#{msg['title.guiaremision']}</ui:define>
    
    <ui:define name="head">
        <style type="text/css">
			
			/* Style the tab */
			.tab {
			  overflow: hidden;
			  border: 1px solid #ccc;
			  background-color: #f1f1f1;
			}

			.tab .tab_button {
				  background-color: inherit;
				  float: left;
				  border: none;
				  outline: none;
				  cursor: pointer;
				  padding: 10px 8px;
				  transition: 0.3s;
				  font-size: 17px;
				  color: black;
				  /* border-right: 1px solid #ccc; */
				}
			.tab .tab_button:hover {
			  background-color: #ddd;
			}
			.tab .tab_buttonactive {
			  background-color: #ccc;
			}
			.tab_content {
			  padding: 5px;
			  border: 1px solid #ccc;
			  border-top: none;
			}
			
			
        </style>
    </ui:define>

    <ui:define name="content">
    	
    	<!-- CONSTANTES -->
    	<o:importConstants type="com.vcw.falecpv.core.constante.EstadoRegistroEnum" var="EstadoRegistroEnum" />
    	<o:importConstants type="com.vcw.falecpv.core.constante.ComprobanteEstadoEnum" var="ComprobanteEstadoEnum" />
    
    	<p:breadCrumb>
		    <p:menuitem url="#{request.contextPath}/pages/main.jsf" />
		    <!-- <p:menuitem value="Retenciones" url="#" /> -->
		    <p:menuitem value="Lista de #{msg['label.notadebito']}" url="#{request.contextPath}/pages/notdebito/notaDebito.jsf"/>
		</p:breadCrumb>
		
		<!-- OPCIONES -->
	    <h:form id="formMain">
	    	<div class="EmptyBox5"/>
	    	<!-- Opciones -->
	    	<div class="card card-w-title">
				
			  <p:outputPanel id="oupTab">
					<div class="tab" id="tabMain">
						  <p:commandLink value="AWB" styleClass="tab_button #{cajaChicaCtrl.activeTab==0?'tab_buttonactive':''}" actionListener="#{cajaChicaCtrl.tabChange(0)}" update=":formMain:oupTab"></p:commandLink>
						  <p:commandLink value="DISTRIBUCION" styleClass="tab_button #{cajaChicaCtrl.activeTab==1?'tab_buttonactive':''}" actionListener="#{cajaChicaCtrl.tabChange(1)}" update=":formMain:oupTab"></p:commandLink>
						  <p:commandLink value="COORDINACION" styleClass="tab_button #{cajaChicaCtrl.activeTab==2?'tab_buttonactive':''}" actionListener="#{cajaChicaCtrl.tabChange(2)}" update=":formMain:oupTab"></p:commandLink>
					</div>
				<!-- 	<div class="tab_content"> -->
					  
					  <p:outputPanel id="tab1" rendered="#{cajaChicaCtrl.activeTab==0}">
								  	<p:dataTable id="pvUnoDT"
					       			scrollable="true"
					       			value="#{facEmitidaCtrl.ventasQueryList}"
					       			var="v"
					       			emptyMessage="#{msg['mensaje.noexistenDatos']}"
									styleClass="pvUnoDT Fs11"
					                paginator="true"
					                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					                currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
					                paginatorPosition="bottom"  
									rowKey="#{v.idcabecera}"
									rows="12"
									rowsPerPageTemplate="10,12,20,30,40">
								
								<p:column headerText="OPC" style="width:20px;" styleClass="TexAlCenter">
								
									<p:commandLink id="cmlDtFacEmitidas">
										<i class="fa fa-chevron-circle-down Fs18" style="color:#252529;"/>
									</p:commandLink>
									
									<p:menu overlay="true" trigger="cmlDtFacEmitidas" my="left top" at="left bottom">
											
										<p:menuitem value="Ver" action="#" icon="fa fa-eye" >
										</p:menuitem>
										<p:menuitem value="RIDE" action="#" icon="fa fa-file-pdf-o" disabled="#{v.estado=='ANULADO'}">
										</p:menuitem>
										<p:menuitem value="Enviar Email" action="#" icon="fa fa-envelope-o" disabled="#{v.estado=='ANULADO'}">
										</p:menuitem>
										<p:menuitem value="Firmar y enviar" action="#" icon="fa fa-envelope" disabled="#{v.estado=='ANULADO'}">
										</p:menuitem>
										<p:menuitem value="#{msg['label.guiaremision']}" action="#{guiaRemFormCtrl.nuevaGuiaRemisionByFactura(v.idcabecera)}" icon="fa fa-truck" disabled="#{v.estado=='ANULADO'}">
											<f:setPropertyActionListener value="FACTURA" target="#{guiaRemFormCtrl.callModule}"/>
										</p:menuitem>
										
										<p:menuitem value="Ver #{msg['label.guiaremision']}" action="#" icon="fa fa-eye" disabled="#{v.estado=='ANULADO' or v.idguiaremision==null}">
										</p:menuitem>
										
										<p:menuitem value="Anular" action="#{facEmitidaCtrl.generarNC()}" icon="fa fa-trash-o" update="@form" disabled="#{v.estado=='ANULADO'}">
											<f:setPropertyActionListener value="#{v}" target="#{facEmitidaCtrl.ventasQuerySelected}"/>
											<p:confirm header="#{msg['label.confirmacion']}" message="#{msg['mensaje.confimacion']}" icon="fa fw-3x fa-exclamation-triangle" />
										</p:menuitem>	
										
									</p:menu>
								
								</p:column>
								
								<p:column headerText="N." style="width:40px;">
									<h:outputText value="#{v.secuencial}" />
								</p:column>
								
								<p:column headerText="FECHA" style="width:40px;">
									<h:outputText value="#{v.fechaemision}" >
										<f:convertDateTime pattern="dd/MM/yyyy"/>
									</h:outputText>
								</p:column>
								
								<p:column headerText="CLIENTE" style="width:125px;">
									<h:outputText value="#{v.razonsocial}" >
									</h:outputText>
								</p:column>
								
								<p:column headerText="VENDEDOR" style="width:60px;">
									<h:outputText value="#{v.nombrepantalla}" >
									</h:outputText>
								</p:column>
								
								<p:column headerText="ESTADO" style="width:50px;">
									<h:outputText value="#{v.estado}" styleClass="#{v.estadoStyle} Fs9">
									</h:outputText>
								</p:column>
								
								<p:column headerText="AUT SRI" style="width:40px;">
									<h:outputText value="#{v.estadoautorizacion}" >
									</h:outputText>
								</p:column>
								
								<p:column headerText="GU.REM" style="width:10px;" styleClass="TexAlCenter">
									<f:subview rendered="#{v.idguiaremision!=null}">
										<i class="fa fa-check Fs14" style="color:green;"/>
									</f:subview>
									<f:subview rendered="#{v.idguiaremision==null}">
										<i class="fa fa-minus Fs14" style="color:#ccc;"/>
									</f:subview>
								</p:column>
								
								<p:column headerText="SUBTOT" style="width:40px;" styleClass="TexAlRight">
									<h:outputText value="#{v.subtotal}" >
										<f:convertNumber pattern="$#,##0.00"/>
									</h:outputText>
								</p:column>
								
								<p:column headerText="DESC" style="width:25px;" styleClass="TexAlRight">
									<h:outputText value="#{v.totaldescuento}" >
										<f:convertNumber pattern="$#,##0.00"/>
									</h:outputText>
								</p:column>
								
								
								<p:column headerText="TOT SIN IVA" style="width:50px;" styleClass="TexAlRight">
									<h:outputText value="#{v.totalsinimpuestos}" styleClass="markBlack">
										<f:convertNumber pattern="$#,##0.00"/>
									</h:outputText>
								</p:column>
								
								<p:column headerText="IMPUESTO" style="width:70px;" styleClass="TexAlCenter">
									
									<div class="p-grid Fs10 p-justify-end">
										<div class="p-col-3" >
											<h:outputText value="I.V.A." styleClass="FontBold"/>
										</div>
										<div class="p-col-7">
											<h:outputText value="#{v.iva}" >
												<f:convertNumber pattern="$#,##0.00"/>
											</h:outputText>
										</div>
										<div class="p-col-3">
											<h:outputText value="I.C.E." styleClass="FontBold"/>
										</div>
										<div class="p-col-7">
											<h:outputText value="#{v.ice}" >
												<f:convertNumber pattern="$#,##0.00"/>
											</h:outputText>
										</div>
									</div>
								
								</p:column>
								
								<p:column headerText="TOTAL" style="width:40px;" styleClass="TexAlRight">
									<h:outputText value="#{v.total}" styleClass="markGreen">
										<f:convertNumber pattern="$#,##0.00"/>
									</h:outputText>
								</p:column>
								
								
								
								<p:column headerText="PAGO" style="width:110px;" styleClass="TexAlLeft">
									
									<div class="p-grid Fs10 p-justify-end">
										<div class="p-col-3" >
											<h:outputText value="PAGO: " styleClass="FontBold"/>
										</div>
										<div class="p-col-7">
											<h:outputText value="#{v.totalpago}" styleClass="#{v.totalpago.doubleValue()!=v.total.doubleValue()?'markRed':'markGreen'}">
												<f:convertNumber pattern="$#,##0.00"/>
											</h:outputText>
										</div>
										<div class="p-col-3" >
											<h:outputText value="ENTREG: " styleClass="FontBold"/>
										</div>
										<div class="p-col-7">
											<h:outputText value="#{v.licitado}" >
												<f:convertNumber pattern="$#,##0.00"/>
											</h:outputText>
										</div>
										<div class="p-col-3" >
											<h:outputText value="CAMBIO: " styleClass="FontBold"/>
										</div>
										<div class="p-col-7">
											<h:outputText value="#{v.cambio}" >
												<f:convertNumber pattern="$#,##0.00"/>
											</h:outputText>
										</div>
										
									</div>
									
								</p:column>
											
							</p:dataTable>
					  </p:outputPanel>
					  <p:outputPanel id="tab2" rendered="#{cajaChicaCtrl.activeTab==1}">
					  	<strong>TAB2 DISTRIBUCION</strong>
					  </p:outputPanel>
					  <p:outputPanel id="tab3" rendered="#{cajaChicaCtrl.activeTab==2}">
					  	<strong>TAB3 COORDINACION</strong>
					  </p:outputPanel>
					  
					<!-- </div> -->
			  </p:outputPanel>
					    		
			</div> 
	    
	    </h:form>
        
        
    </ui:define>

</ui:composition>
