<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="title">ICE</ui:define>
    
    <ui:define name="head">
        <style type="text/css">
        	
        	.iceDT .ui-datatable-scrollable-body{
				min-height: 30vh !important;
				height: calc(100vh - 260px)!important;
			}	
			
			/* body .ui-messages, 
			body .ui-message {
				padding: 0em !important;
				margin: 0em !important;
				display: block !important;
			} */
			
			@media screen and (max-width: 40em){
					.ui-fileupload-buttonbar .ui-button .ui-button-text {
					display: block !important;
				}
			}
			
			body .ui-fileupload .ui-fileupload-buttonbar {
			 border: none;
			 padding: 0px !important;
			}	
			
			body .ui-fileupload .ui-fileupload-content {
				/* display: none; */
				border: none;
				padding: 0px;
				border-top: 0 none;
				line-height: 1.5;
			}
			
			body .ui-fileupload .ui-fileupload-buttonbar .ui-button {
				width: 100%;
			}
        </style>
    </ui:define>

    <ui:define name="content">
    	
    	<!-- CONSTANTES -->
    	<o:importConstants type="com.vcw.falecpv.core.constante.EstadoRegistroEnum" var="EstadoRegistroEnum" />
    	
    	<p:breadCrumb>
		    <p:menuitem url="#{request.contextPath}/pages/main.jsf" />
		    <p:menuitem value="#{msg['menu.configuracion']}" url="#" />
		    <p:menuitem value="ICE" url="#{request.contextPath}/pages/configuracion/ice.jsf" />
		</p:breadCrumb>
	    
	    <!-- OPCIONES -->
	    <h:form id="formMain">
	    	<div class="EmptyBox5"/>
	    	<div class="card card-w-title">
	    	
	    		<div class="p-grid p-align-center">
	    			
	    			<!-- opciones -->
	    			<div class="p-col-12 p-md-8" style="text-align:center;">
	    				
	    				<p:panelGrid columns="1"
								style="margin:0px;border:none !important;width:100%;"
								layout="grid"
								columnClasses="ui-g-12">
								
								<p:panelGrid columns="4" style="border:none !important;margin:0px;width:100%;" 
									columnClasses="ui-g-12 ui-lg-2,ui-g-12 ui-lg-2,ui-g-12 ui-lg-4,ui-g-12 ui-lg-2">
												   
									<p:commandButton id="cmdRefrecar"
											value="CONSULTAR" icon="fa fa-search" 
											action="#{iceCtrl.refrescar()}" styleClass="secondary-button Wid100" update="@form"
											/>
																									
									<p:commandButton id="cmdNuevo"
										value="NUEVO" icon="fa fa-plus" styleClass="secondary-button Wid100" 
										action="#{iceCtrl.nuevo()}" inline="true">
									</p:commandButton>
									
									<p:commandButton  id="cmdExcelCargar" 
										title="CARGAR ARCHIVO EXCEL ICE"
										icon="fa fa-file-excel-o"
										value="IMPORTAR VALORES ICE"
										styleClass="secondary-button Wid100"
										onclick="PF('dlgImportIce').show()"
										update=":frmImportIce"
										immediate="true">
										<f:setPropertyActionListener value="#{null}" target="#{iceCtrl.nombreFileIce}"/>
										<f:setPropertyActionListener value="#{null}" target="#{iceCtrl.fileIces}"/>
										<f:setPropertyActionListener value="#{false}" target="#{iceCtrl.existeNovedadesIce}"/>
										<f:setPropertyActionListener value="#{false}" target="#{iceCtrl.renderResultadoImportIce}"/>
									</p:commandButton>
									
									<p:commandButton  id="cmdExcel" 
										title="EXPORTAR"
										icon="fa fa-file-excel-o"
										ajax="false" onclick="PrimeFaces.monitorDownload(start,stop)"
										value="REPORTE"
										styleClass="secondary-button Wid100">
										<p:fileDownload value="#{iceCtrl.fileIce}"/>
									</p:commandButton>
									
									
									
									
								</p:panelGrid>
								
						</p:panelGrid>
	    			</div>
	    		</div>
	    	</div>
	    	
    	<!-- Mensajes -->
		<p:messages rendered="#{not facesContext.validationFailed}" showSummary="true" showDetail="true" for="formMain"
			closable="true" >
			<p:autoUpdate></p:autoUpdate>
		</p:messages>
		<div class="card card-w-title">
			<p:dataTable id="iceDT" 
						var="ice" 
						value="#{iceCtrl.iceAllList}" 
						widgetVar="icedt" 
						styleClass="iceDT"
						scrollable="true"
						rowKey="#{ice.idice}"
		                 emptyMessage="No existen concidencias">
		  
		  		<p:column headerText="OPC" style="width:80px;" styleClass="TexAlCenter">
						
						<p:commandLink id="cmlDtIce">
							<i class="fa fa-chevron-circle-down Fs18" style="color:#252529;"/>
						</p:commandLink>
						
						<p:menu overlay="true" trigger="cmlDtIce" my="left top" at="left bottom">
							
							<p:menuitem value="Editar" action="#{iceCtrl.editar()}" icon="fa fa-edit">
								<f:setPropertyActionListener value="#{ice}" target="#{iceCtrl.iceSelected}"/>
							</p:menuitem>
							
							<p:menuitem value="Eliminar" action="#{iceCtrl.eliminar()}" update="@form" icon="fa fa-trash-o" >
								<f:setPropertyActionListener value="#{ice}"
									target="#{iceCtrl.iceSelected}" />
								<p:confirm header="#{msg['label.confirmacion']}"
									message="#{msg['mensaje.confimacion']}"
									icon="fa fw-3x fa-exclamation-triangle" />
							</p:menuitem>
							
						</p:menu>
						
					</p:column>
		  		
		        <p:column headerText="Id"  filterMatchMode="contains" style="width:80px;">
		            <h:outputText value="#{ice.idice}" />
		        </p:column>
		        
		        <p:column  filterBy="#{ice.codigo}" filterMatchMode="contains" style="width:80px;">
						<f:facet name="header">
							<h:outputText value="#{msg['label.codigo']}" />
							<h:outputText value=" [filtro]"  style="color:gray;"/>
						</f:facet>
						<h:outputText value="#{ice.codigo}" />
				</p:column>
				
				<p:column headerText="ESTADO" style="width:40px;">
					<h:outputText value="#{ice.estado=='I'?'INA':'ACT'}" styleClass="DispBlock #{ice.estado=='I'?'markRed':''}"/>
				</p:column>
					
		         <p:column  headerText="TARIFA AD VALOREM"  filterMatchMode="contains" style="width:120px;">
		             <h:outputText value="#{ice.tarifaadvalorem}" />
		        </p:column>
		        
		        <p:column filterBy="#{ice.descripcion}"  filterMatchMode="contains" style="width:420px;">
		                <f:facet name="header">
							<h:outputText value="#{msg['label.descripcion']}" />
							<h:outputText value=" [filtro]"  style="color:gray;"/>
						</f:facet>
						 <h:outputText value="#{ice.descripcion}" />
		        </p:column>
		        
		        <p:column  headerText="VALOR"  filterMatchMode="contains" style="width:120px;" styleClass="TexAlRight">
		            <h:outputText value="#{ice.valor}" >
		            	<f:convertNumber pattern="#{appSessionCtrl.formatoNumber}"/>
		            </h:outputText>
		        </p:column>
		 
		        
           </p:dataTable>
	    </div>
	    	<div class="EmptyBox20"/>
	    </h:form>
	     <!-- formulario iva -->
	    <ui:include src="incl_ice_form.xhtml" />
	    
	        <!-- Form carga ice -->
	    <ui:include src="incl_cargarIce_form.xhtml" />
	    
    </ui:define>
    
    
    

</ui:composition>
