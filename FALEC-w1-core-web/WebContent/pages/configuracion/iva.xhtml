<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="title">IVA</ui:define>
    
    <ui:define name="head">
        <style type="text/css">
        	
        	.ivaDT .ui-datatable-scrollable-body{
				min-height: 30vh !important;
				height: calc(100vh - 280px)!important;
			}	
			
        </style>
    </ui:define>

    <ui:define name="content">
    	
    	<!-- CONSTANTES -->
    	<o:importConstants type="com.vcw.falecpv.core.constante.EstadoRegistroEnum" var="EstadoRegistroEnum" />
    	
    	<p:breadCrumb>
		    <p:menuitem url="#{request.contextPath}/pages/main.jsf" />
		    <p:menuitem value="#{msg['menu.configuracion']}" url="#" />
		    <p:menuitem value="Iva" url="#{request.contextPath}/pages/configuracion/iva.jsf" />
		</p:breadCrumb>
	    
	    <!--OPCIONES -->
		<h:form id="formMain">
			<div class="card card-w-title" style="margin-top: 12px;">
				<div class="p-grid">

					<div class="p-col-12 p-md-5 p-justify-start">
						<p:panelGrid columns="1"
							style="margin:0px;border:none !important;width:100%;"
							layout="grid" columnClasses="ui-g-12">

							<p:panelGrid columns="4"
								style="border:none !important;margin:0px;width:100%;"
								columnClasses="ui-g-12 ui-lg-4,
												   ui-g-12 ui-lg-4,
												   ui-g-12 ui-lg-4">
								
								<p:commandButton id="cmdRefrecar" value="CONSULTAR"
									icon="fa fa-search"
									action="#{ivaCtrl.refrescar()}"
									styleClass="secondary-button Wid100" update="@form" />

								<p:commandButton id="nuevoIva"
									value="NUEVO"
								 icon="fa fa-plus" 
								 styleClass="secondary-button Wid100"
								 action="#{ivaCtrl.nuevo()}" inline="true"
									 />

								<p:commandButton id="cmdExcelEstab" title="EXPORTAR"
									icon="fa fa-file-excel-o" ajax="false"
									onclick="PrimeFaces.monitorDownload(start,stop)"
									value="REPORTE" styleClass="secondary-button Wid100">
									<p:fileDownload value="#{ivaCtrl.fileIva}" />
								</p:commandButton>

							</p:panelGrid>
						</p:panelGrid>
					</div>
				</div>
			</div>
			
			<!-- Mensajes -->
			<p:messages rendered="#{not facesContext.validationFailed}" showSummary="true" showDetail="true" for="formMain"
				closable="true" >
				<p:autoUpdate></p:autoUpdate>
			</p:messages>
			
			<div class="card card-w-title">
				<p:dataTable var="iva"
					value="#{ivaCtrl.ivaAllList}"
					scrollable="true" styleClass="ivaDT"
					rowKey="#{iva.idiva}">

					<p:column headerText="OPC" style="width:40px;" styleClass="TexAlCenter">
						
						<p:commandLink id="cmlDtIva">
							<i class="fa fa-chevron-circle-down Fs18" style="color:#252529;"/>
						</p:commandLink>
						
						<p:menu overlay="true" trigger="cmlDtIva" my="left top" at="left bottom">
							<p:menuitem value="Editar" action="#{ivaCtrl.editar()}" icon="fa fa-edit">
								<f:setPropertyActionListener value="#{iva}" target="#{ivaCtrl.ivaSelected}" />
							</p:menuitem>
							<p:menuitem value="Eliminar" action="#{ivaCtrl.eliminar()}" update="@form" icon="fa fa-trash-o" >
								<f:setPropertyActionListener value="#{iva}"
									target="#{ivaCtrl.ivaSelected}" />
								<p:confirm header="#{msg['label.confirmacion']}"
									message="#{msg['mensaje.confimacion']}"
									icon="fa fw-3x fa-exclamation-triangle" />
							</p:menuitem>
						</p:menu>
						
					</p:column>
					
					<p:column headerText="ID"
						style="width:20px; text-align: center;">
						<h:outputText value="#{iva.idiva}" />
					</p:column>

					<p:column headerText="#{msg['label.codigo']}" style="width:80px;">
						<h:outputText value="#{iva.codigo}" />
					</p:column>

					<p:column headerText="PORCENTAJE" priority="1"
						style="width:80px; ">
						<h:outputText value="#{iva.porcentaje}" />
					</p:column>

					<p:column headerText="VALOR"
						style="width:30px; text-align: center; ">
						<h:outputText value="#{iva.valor}" >
						 <f:convertNumber pattern="#{appSessionCtrl.formatoPorcentaje}"/>
						</h:outputText>
					</p:column>
					
					<p:column headerText="DEFECTO"
						style="width:30px; text-align: center; ">
						<h:outputText value="#{iva.defecto==0? 'No':'Si'}" styleClass="#{iva.defecto==0?'markRed':'markGreen'}"/>
					</p:column>

				</p:dataTable>
			</div>
			
	    </h:form>
	     <!-- formulario iva -->
	    <ui:include src="incl_iva_form.xhtml" />
    </ui:define>
    
    
    

</ui:composition>
