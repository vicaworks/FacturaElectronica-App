<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/template/template.xhtml">

	<ui:define name="title">#{msg['title.establecimiento']}</ui:define>

		<ui:define name="head">
			<style type="text/css">
				.establecimientoDT .ui-datatable-scrollable-body {
					min-height: 30vh !important;
					height: calc(100vh - 280px)!important;
				}
				@media screen and (max-width: 40em){
					.ui-fileupload-buttonbar .ui-button .ui-button-text {
		 				display: block !important;
		 				padding: 0px !important;
					}
				}
			</style>
		</ui:define>

	<ui:define name="content">

		<p:breadCrumb>
			<p:menuitem url="#{request.contextPath}/pages/main.jsf" />
			<p:menuitem value="#{msg['menu.configuracion']}" url="#" />
			<p:menuitem value="Establecimiento"
				url="#{request.contextPath}/pages/configuracion/empresa.jsf" />
		</p:breadCrumb>

		<!--OPCIONES -->
		<h:form id="formMain">
			<div class="card card-w-title" style="margin-top: 12px;">
				<div class="p-grid">

					<div class="p-col-12 p-md-5 p-justify-start">
						<p:panelGrid columns="1"
							style="margin:0px;border:none !important;width:100%;"
							layout="grid" columnClasses="ui-g-12">

							<p:panelGrid columns="4"
								style="border:none !important;margin:0px;width:100%;"
								columnClasses="ui-g-12 ui-lg-4,
												   ui-g-12 ui-lg-4,
												   ui-g-12 ui-lg-4">
												   
								<p:commandButton id="cmdRefrecar" value="CONSULTAR"
									icon="fa fa-search"
									action="#{establecimientoCtrl.refrescar()}"
									styleClass="secondary-button Wid100" update="@form" />

								<p:commandButton id="nuevoEstablecim"
									value="NUEVO"
								 icon="fa fa-plus" 
								 styleClass="secondary-button Wid100"
								 action="#{establecimientoCtrl.nuevo()}" inline="true"
									 />

								<p:commandButton id="cmdExcelEstab" title="EXPORTAR"
									icon="fa fa-file-excel-o" ajax="false"
									onclick="PrimeFaces.monitorDownload(start,stop)"
									value="REPORTE" styleClass="secondary-button Wid100">
									<p:fileDownload value="#{establecimientoCtrl.fileEstablecimientos}" />
								</p:commandButton>

							</p:panelGrid>
						</p:panelGrid>
					</div>
				</div>
			</div>
			
			<!-- Mensajes -->
			<p:messages rendered="#{not facesContext.validationFailed}" showSummary="true" showDetail="true" for="formMain"
				closable="true" >
				<p:autoUpdate></p:autoUpdate>
			</p:messages>
			
			
			<div class="card card-w-title">
				<p:dataTable var="estab"
					value="#{establecimientoCtrl.establecimientoAllList}"
					scrollable="true" styleClass="establecimientoDT"
					rowKey="#{estab.codigoestablecimiento}">

					<p:column headerText="OPC" style="width:40px;" styleClass="TexAlCenter">
						
						<p:commandLink id="cmlDtEstablecimiento">
							<i class="fa fa-chevron-circle-down Fs18" style="color:#252529;"/>
						</p:commandLink>
						
						<p:menu overlay="true" trigger="cmlDtEstablecimiento" my="left top" at="left bottom">
							<p:menuitem value="Editar" action="#{establecimientoCtrl.editar()}" icon="fa fa-edit">
								<f:setPropertyActionListener value="#{estab}" target="#{establecimientoCtrl.establecimientoSelected}" />
							</p:menuitem>
							<p:menuitem value="Eliminar" action="#{establecimientoCtrl.eliminar()}" update="@form" icon="fa fa-trash-o" >
								<f:setPropertyActionListener value="#{estab}"
								target="#{establecimientoCtrl.establecimientoSelected}" />
								<p:confirm header="#{msg['label.confirmacion']}"
									message="#{msg['mensaje.confimacion']}"
									icon="fa fw-3x fa-exclamation-triangle" />
							</p:menuitem>
						</p:menu>
						
						<!-- <p:commandLink id="clkEditar"
							action="#{establecimientoCtrl.editar()}">
							<i class="fa fa-edit Fs16"></i>
							<f:setPropertyActionListener value="#{estab}"
								target="#{establecimientoCtrl.establecimientoSelected}" />
						</p:commandLink>

						<p:spacer width="5px"></p:spacer>

						<p:commandLink id="clkEliminar"
							action="#{establecimientoCtrl.eliminar()}" update="@form">
							<i class="fa fa-close Fs18" style="color: red;"></i>
							<f:setPropertyActionListener value="#{estab}"
								target="#{establecimientoCtrl.establecimientoSelected}" />
							<p:confirm header="#{msg['label.confirmacion']}"
								message="#{msg['mensaje.confimacion']}"
								icon="fa fw-3x fa-exclamation-triangle" />
						</p:commandLink> -->


					</p:column>
					<p:column headerText="#{msg['label.codigo']}"
						style="width:10px; text-align: center;">
						<h:outputText value="#{estab.codigoestablecimiento}" />
					</p:column>

					<p:column headerText="#{msg['label.direccion']}" style="width:80px;">
						<h:outputText value="#{estab.direccionestablecimiento}" />
					</p:column>

					<p:column headerText="NOMBRE COMERCIAL" priority="1"
						style="width:100px; ">
						<h:outputText value="#{estab.nombrecomercial}" />
					</p:column>

					<p:column headerText="PUNTO #{msg['label.emision']}"
						style="width:30px; text-align: center; ">
						<h:outputText value="#{estab.puntoemision}" />
					</p:column>

					<p:column headerText="#{msg['label.telefono']}" style="width:70px;">
						<h:outputText value="#{estab.telefono}" />
					</p:column>

					<p:column headerText="CORREO" style="width:80px;">
						<h:outputText value="#{estab.correo}" />
					</p:column>

					<p:column headerText="MATRIZ"
						style="width:20px; text-align: center;">
						<h:outputText value="#{estab.matriz}" />
					</p:column>
					
					<p:column headerText="AMBIENTE"
						style="width:20px; text-align: center;">
						<h:outputText value="#{estab.ambiente==1? 'Desarrollo':'Produccion'}" />
					</p:column>

				</p:dataTable>
			</div>
						
		</h:form>		
		 
	    <!-- formulario establecimiento -->
	    <ui:include src="incl_establecimiento_form.xhtml" />

	</ui:define>

</ui:composition>
