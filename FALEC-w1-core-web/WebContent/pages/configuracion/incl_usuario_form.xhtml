<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		.heightFrmUsuario {height:760px;max-height: 760px;}
		@media screen and (max-height: 1024px){
			.heightFrmUsuario {
				max-height: 800px;
			}
		}
		
	</style>
	
	<p:dialog header="Usuario" 
		widgetVar="dlgUsuario" 
		modal="true" 
		responsive="true" 
		width="99%"
		style="max-width:50rem" 
		closeOnEscape="true" 
		styleClass="modalResponsivo">
		
		<h:form id="frmUsuario">
			<!-- OPCIONES -->
			<div class="tool-bar mb-2">
				<i class="fa-solid fa-ellipsis-vertical"></i>			
				<p:commandButton id="cmdGuardar"
					value="Guardar" icon="fa-regular fa-floppy-disk fs-12" 
					action="#{usuarioCtrl.guardar()}" 
					styleClass="fs-12 min-width-110 ui-button-success" 
					update="@form :fsvUsuario:frmMainUsuario"
					/>
					
				<p:commandButton id="cmdCerrar"
					value="Cerrar" styleClass="min-width-110 ui-button-secondary ui-button-outlined fs-12" 
					onclick="PF('dlgUsuario').hide()" immediate="true"  
					/>
			</div>
			
			<!--  wraper del formulario para responsive -->
			<div class="w-full overflow-auto heightFrmUsuario contenedorFormulario">
				
				<div style="width: 99.5%!important;" class="ui-fluid">
				
					<div class="field">
						<label class="text-gray-800 fw-5">Empresa</label>
						<p:inputText readonly="true" value="#{usuarioCtrl.usuarioSelected.empresa.nombrecomercial}"/>
				    </div>
				
					<div class="field">
						<label class="text-gray-800 fw-5">Establecimiento</label>
						<p:selectOneMenu id="somEstablecimientos"
							value="#{usuarioCtrl.usuarioSelected.establecimiento}"
							converter="omnifaces.SelectItemsConverter"
							required="true"
							requiredMessage="Requerido"
							styleClass="w-full">
							<f:selectItem itemLabel="#{msg['label.seleccionar']} ..."
									itemValue="#{null}" value="#{null}" noSelectionOption="true" />
	
							<f:selectItems value="#{usuarioCtrl.establecimientoList}" var="a"
								itemLabel="#{a.nombrecomercial}" itemValue="#{a}" />
						</p:selectOneMenu>
						<p:message for="somEstablecimientos" styleClass="block m-0 p-0"/>
				    </div>
				
					<div class="field">
						<label class="text-gray-800 fw-5">Nombre Usuario</label>
						<p:inputText id="intNombre" value="#{usuarioCtrl.usuarioSelected.nombre}" required="true" requiredMessage="Requerido" maxlength="300" converter="omnifaces.ToUpperCaseConverter"/>
						<p:message for="intNombre" styleClass="block m-0 p-0"/>
					</div>
				
					<div class="field">
						<label class="text-gray-800 fw-5">Nombre Corto</label>
						<p:inputText id="intNombrePantalla" value="#{usuarioCtrl.usuarioSelected.nombrepantalla}" required="true" requiredMessage="Requerido" styleClass="w-full" maxlength="20" converter="omnifaces.ToUpperCaseConverter"/>
						<small>Nombre de la pantalla</small>
						<p:message for="intNombrePantalla" styleClass="block m-0 p-0"/>
					</div>
				
					<div class="field">
						<label class="text-gray-800 fw-5">Identificación</label>
						<p:inputText id="intIdentifiaccion" value="#{usuarioCtrl.usuarioSelected.identificacion}" required="true" requiredMessage="Requerido" styleClass="w-full" maxlength="20"/>
						<p:message for="intIdentifiaccion" styleClass="block m-0 p-0"/>
					</div>
					
					<div class="field">
						<label class="text-gray-900">Teléfono</label>
						<p:inputText id="intTelefono" value="#{usuarioCtrl.usuarioSelected.telefono}" required="true" requiredMessage="Requerido" styleClass="w-full" maxlength="20" validatorMessage="SOLO NÚMEROS">
							<f:validateRegex pattern="[0-9]+"></f:validateRegex>
						</p:inputText>
						<p:message for="intTelefono" styleClass="block m-0 p-0"/>
					</div>
				
					<div class="field">
						<label class="text-gray-900">Email</label>
						<p:inputText id="intEmailUsuario" value="#{usuarioCtrl.usuarioSelected.correoelectronico}" required="false" requiredMessage="Requerido" styleClass="w-full" maxlength="100">
							<f:validator validatorId="emailSelectItemValidator"/>
						</p:inputText>
						<p:message for="intEmailUsuario" styleClass="block m-0 p-0"/>
					</div>
					<div class="field">
						<label class="text-gray-800 fw-5">Punto Emisión</label>
						<p:inputText id="intPuntoEmision" value="#{usuarioCtrl.usuarioSelected.puntoemision}" required="true" requiredMessage="Requerido" converterMessage="SOLO NÚMEROS" styleClass="w-full" maxlength="3" validatorMessage="SOLO NÚMEROS">
							<f:validateRegex pattern="[0-9]+"></f:validateRegex>
						</p:inputText>
						<p:message for="intPuntoEmision" styleClass="block m-0 p-0"/>
					</div>
					<div class="field">
						<label class="text-gray-900">Firma email</label>
						<p:textEditor secure="false" id="teefirmaemail" widgetVar="teefirmaemail" value="#{usuarioCtrl.usuarioSelected.firmaemail}" height="150"  />
						<p:message for="teefirmaemail" styleClass="block m-0 p-0"/>
					</div>
					<div class="field">
						<label class="text-gray-900 mr-1">Actualizar Credenciales</label>
						<p:selectBooleanCheckbox value="#{usuarioCtrl.usuarioSelected.actualizarCredenciales}" disabled="#{usuarioCtrl.usuarioSelected.idusuario == null}">
							<p:ajax update=":frmUsuario:grid2" event="change" process="@this"/>
						</p:selectBooleanCheckbox>
						<small class="block">Obliga actualizar las credenciales al iniciar sesión</small>
					</div>		
				
						
					<p:outputPanel id="grid2" >
						<p:outputPanel rendered="#{usuarioCtrl.usuarioSelected.actualizarCredenciales}">
							<div class="field">
								<label class="text-gray-900 mr-1">Login</label>
								<p:inputText id="intLogin" value="#{usuarioCtrl.usuarioSelected.login}" required="true" requiredMessage="Requerido" maxlength="50" readonly="#{usuarioCtrl.usuarioSelected.idusuario!=null}"/>
								<p:message for="intLogin"  id="intLogin2" styleClass="block m-0 p-0"/>
							</div>
							
							<div class="field">
								<label class="text-gray-900 mr-1">Clave</label>
								<p:password id="intClave1" value="#{usuarioCtrl.usuarioSelected.clave}" required="true" requiredMessage="Requerido" styleClass="w-full" maxlength="50" />
								<p:message for="intClave1" id="intClave12" styleClass="block m-0 p-0"/>
							</div>
							<div class="field">
								<label class="text-gray-900 mr-1">Confirmación</label>
								<p:password id="intClave2" value="#{usuarioCtrl.usuarioSelected.clave2}" required="true" requiredMessage="Requerido" styleClass="w-full" maxlength="50" rendered="#{usuarioCtrl.usuarioSelected.actualizarCredenciales}"/>
								<p:message for="intClave2" id="intClave22" styleClass="block m-0 p-0"/>
							</div>
						</p:outputPanel>
					</p:outputPanel>
				
					<div class="field">
						<label class="text-gray-900 fw-5">Estado</label>
						<p:selectOneMenu id="somEstadoUsu"
							value="#{usuarioCtrl.usuarioSelected.estado}"
							required="true"
							requiredMessage="Requerido"
							styleClass="w-full" disabled="#{usuarioCtrl.usuarioSelected.idusuario==null}">
							
							<f:selectItem itemLabel="#{EstadoRegistroEnum.ACTIVO}" itemValue="A" />
			    			<f:selectItem itemLabel="#{EstadoRegistroEnum.INACTIVO}" itemValue="I" />
			    			
						</p:selectOneMenu>
						<p:message for="somEstadoUsu" styleClass="block m-0 p-0"/>
					</div>
				</div>
			</div>
		</h:form>
   </p:dialog>

</ui:composition>
