<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions"
				xmlns:pe="http://primefaces.org/ui/extensions">
	
	<style type="text/css">
		.frmFactura .ui-inputnumber .ui-inputfield{width: 100%!important;font-size: 14px;}
	</style>
		
	<div class="w-full overflow-auto heightFrmListProducto frmFactura ui-fluid">
         <div style="width:98.5%!important;">
	         <div class="field">	         
		        <label for="intFacCodigo" class="text-gray-900 fw-5">CÃ³digo</label>
	            <p:inputText id="intFacCodigo" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.codproducto}" styleClass="w-full" required="true" requiredMessage="REQUERIDO" maxlength="25"
	            	readonly="#{listaProductoCtrl.tipoRegistro==1}">
	            </p:inputText>		        
		    </div>
		    <div class="field">
		        <label for="intFacDescripcion" class="text-gray-900 fw-5">Nombre</label>    
	        	<p:inputTextarea id="intFacDescripcion" rows="4" styleClass="w-full" maxlength="300" 
	        		value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.descripcion}" required="true" requiredMessage="REQUERIDO"></p:inputTextarea>	            
	            <p:message for="intFacDescripcion" styleClass="block"/>
		   </div>
		   <p:divider align="left" style="width:96%;" styleClass="my-2">
		        <div class="flex justify-content-center">		  
		            <span class="text-gray-900 fs-12">Precios de venta</span>
		        </div>
		    </p:divider>
		   <p:outputPanel id="oupPrecios" rendered="#{listaProductoCtrl.tipoRegistro==1}">
			   	<div class="flex gap-2">			   		
			   		<div class="flex-grow-1 flex">
			   			<p:commandLink styleClass="w-full" action="#{listaProductoCtrl.cotizacionFormCtrl.cambiarPrecioVenta(1)}" process="@this" update="@form">
				   			<div class="flex border-1 border-round border-gray-200 py-2 w-full #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==1?'bg-blue-500':''}" style="margin: 5px 0px 5px 0px;">
				   				<div class="flex justify-content-between w-full">
				   					<span class="fs-14  #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==1?'text-white':'text-gray-700'} font-bold mx-2 fs-16">1</span>
				   					<span class="fs-14 #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==1?'text-white font-bold':'text-gray-600'} mx-2">
				   						<h:outputText value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto!=null?listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.preciouno:0.00}" >
				   							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				   						</h:outputText>				   						
				   					</span>
				   				</div>
				   			</div>
			   			</p:commandLink>
			   		</div>
			   		<div class="flex-grow-1 flex">
			   			<p:commandLink styleClass="w-full" action="#{listaProductoCtrl.cotizacionFormCtrl.cambiarPrecioVenta(2)}" process="@this" update="@form">
				   			<div class="flex border-1 border-round border-gray-200 py-2 w-full #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==2?'bg-blue-500':''}" style="margin: 5px 0px 5px 0px;">
				   				<div class="flex justify-content-between w-full">
				   					<span class="fs-14 #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==2?'text-white':'text-gray-700'} font-bold mx-2 fs-16">2</span>
				   					<span class="fs-14 #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==2?'text-white font-bold':'text-gray-600'} mx-2">
				   						<h:outputText value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto!=null?listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.preciodos:0.00}" >
				   							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				   						</h:outputText>
				   					</span>
				   				</div>
				   			</div>
				   		</p:commandLink>
			   		</div>
			   		<div class="flex-grow-1">
			   			<p:commandLink styleClass="w-full" action="#{listaProductoCtrl.cotizacionFormCtrl.cambiarPrecioVenta(3)}" process="@this" update="@form">
				   			<div class="flex border-1 border-round border-gray-200 py-2 w-full #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==3?'bg-blue-500':''}" style="margin: 5px 0px 5px 0px;">
				   				<div class="flex justify-content-between w-full">
				   					<span class="fs-14 #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==3?'text-white':'text-gray-700'} font-bold mx-2 fs-16">3</span>
				   					<span class="fs-14 #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.precioVenta==3?'text-white font-bold':'text-gray-600'} mx-2">
				   						<h:outputText value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto!=null?listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.preciotres:0.00}" >
				   							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				   						</h:outputText>
				   					</span>
				   				</div>
				   			</div>
				   		</p:commandLink>
			   		</div>
			   	</div>
		   </p:outputPanel>
		   <div class="grid mt-2">
		   		<div class="col-6 md:col-4">
		   			<div class="flex flex-column">
		   				<label class="text-gray-900 fw-5">Cantidad</label>
		   				<p:inputNumber id="innCantFrm" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.cantidad}"
	                   	    symbolPosition="s" emptyValue="zero" decimalPlaces="3" rendered="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto==null or (listaProductoCtrl.cotizacionFormCtrl.detalleSelected!=null and listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.tipoventa==2)}">
	                   	    <p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>                   	    
	                   	</p:inputNumber>
	                   	<p:inputNumber id="innCantFrm2" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.cantidad}"
	                   	    symbolPosition="s" emptyValue="zero" decimalPlaces="0" rendered="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto!=null and (listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.tipoventa==1 or listaProductoCtrl.cotizacionFormCtrl.detalleSelected.producto.tipoventa==3)}">
	                   	    <p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>                   	    
	                   	</p:inputNumber>
		   			</div>
		   		</div>
		   		<div class="col-6 md:col-4">
		   			<div class="flex flex-column">
		   				<label class="text-gray-900 fw-5">Valor unitario</label>
		   				<p:inputNumber id="innCantDt" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.preciounitario}" onfocus="this.setSelectionRange(0, this.value.length);"
	                   	    symbolPosition="s" emptyValue="zero" decimalPlaces="2">
	                   	    <p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>                   	    
	                   	</p:inputNumber>
		   			</div>
		   		</div>
		   		<div class="col-6 md:col-4">
		   			<div class="field">
		   				<label class="text-gray-900 fw-5">Descuento</label>
		   				<div class="flex gap-1">
		   					<p:inputNumber id="intAdFrDesc1" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.porcentajeDescuento}" symbol="%"
		                   	    symbolPosition="s" emptyValue="zero" decimalPlaces="3" 
		                   	    disabled="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.preciototalsinimpuesto.doubleValue()==0}">
		                   	    <p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>                   	    
		                   	</p:inputNumber>
		   					<p:inputNumber id="intAdFrDesc2" value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.descuento}"
		                   	    symbolPosition="s" emptyValue="zero" decimalPlaces="2" 
		                   	    disabled="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.preciototalsinimpuesto.doubleValue()==0}">
		                   	    <p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemActionConDescuento(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>                   	    
		                   	</p:inputNumber>
		   				</div>
		   			</div>		   		
         		</div>
         		<div class="col-6 md:col-4 mt-2">     
         			<div class="field">
	         			<label for="intAdqCodigo" class="text-gray-900 fw-5">Sin impuestos</label>
	         			<p:inputNumber  
	   						value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.preciototalsinimpuesto}"
	                   	    symbolPosition="s" 
	                   	    emptyValue="zero" 
	                   	    decimalPlaces="2"
	                   	    readonly="true">                   	    
	                   	</p:inputNumber>
	                </div>
         		</div>
         		<div class="col-6 md:col-4 mt-2">
	   				<label class="text-gray-900 fw-5">I.C.E.</label>
	   				<div class="flex gap-1">
	   					<p:selectOneMenu id="somdetIceItem2"
							value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.ice}"
							converter="omnifaces.SelectItemsConverter"
							required="true"
							requiredMessage="REQUERIDO"
							styleClass="fs-12 flex-1">
	
							<f:selectItems value="#{listaProductoCtrl.cotizacionFormCtrl.iceList}" var="ice"
										itemLabel="#{ice.descripcion}" itemValue="#{ice}" />
									
							<p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>
							
						</p:selectOneMenu>
						<p:inputNumber  
	   						value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.valorice}"
	                   	    symbolPosition="s" 
	                   	    emptyValue="zero" 
	                   	    decimalPlaces="2"
	                   	    readonly="true"
	                   	    styleClass="flex-1">                   	    
	                   	</p:inputNumber>
	   				</div>		   		
         		</div>         		
         		<div class="col-6 md:col-4 mt-2">
	   				<label for="intAdqCodigo" class="text-gray-900 fw-5">I.V.A.</label>
	   				<div class="flex gap-1">
	   					<p:selectOneMenu id="somdetIvaItem2"
							value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.iva}"
							converter="omnifaces.SelectItemsConverter"
							required="true"
							requiredMessage="REQUERIDO"
							styleClass="fs-12 flex-1">
	
							<f:selectItems value="#{listaProductoCtrl.cotizacionFormCtrl.ivaList}" var="iva2"
									itemLabel="#{iva2.porcentaje}" itemValue="#{iva2}" />
									
							<p:ajax event="change" listener="#{cotizacionFormCtrl.calcularItemAction(true,listaProductoCtrl.cotizacionFormCtrl.detalleSelected)}" update="@form" process="@form"/>
							
						</p:selectOneMenu>
						<p:inputNumber  
	   						value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.valoriva}"
	                   	    symbolPosition="s" 
	                   	    emptyValue="zero" 
	                   	    decimalPlaces="2"
	                   	    readonly="true"
	                   	    styleClass="flex-1">                   	    
	                   	</p:inputNumber>
	   				</div>		   		
         		</div>
         		<div class="col-12">
         			<div class="flex justify-content-center">
	 					<h:outputText value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.preciototal}" 
	 						styleClass="fs-25 text-gray-900 fw-5">
	   						<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
	   					</h:outputText>
         			</div>
         		</div>
         	</div>         	
	   </div>            			
	</div>
	
	<div class="flex justify-content-center py-3 gap-2">
		<p:commandLink styleClass="text-white min-width-100" 
			update="@form #{listaProductoCtrl.viewUpdate}" 
			actionListener="#{listaProductoCtrl.cotizacionFormCtrl.agregarDetalle()}" 
			action="#{listaProductoCtrl.limpiar()}">
			<f:setPropertyActionListener value="#{null}" target="#{listaProductoCtrl.criterioBusqueda}"/>
			<div class="flex border-1 border-gray-800 bg-green-600 justify-content-center p-2">
				<i class="fs-14 fa #{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.accion=='EDITAR'?'fa-check':'fa-plus'} mr-1"/>
				<span class="fs-14">
					<h:outputText value="#{listaProductoCtrl.cotizacionFormCtrl.detalleSelected.accion=='EDITAR'?'Aceptar':'Agregar'}" /> 
				</span>
			</div>
		</p:commandLink>
		
		<p:commandLink styleClass="text-gray-600 min-width-100" 
			process="@this" 
			action="#{listaProductoCtrl.limpiar()}" 
			update="@form">
			<div class="flex border-1 border-gray-800 justify-content-center p-2">
				<i class="fs-14 fa fa-eraser mr-1"/>
				<span class="fs-14">Limpiar</span>
			</div>
		</p:commandLink>
	</div>	

</ui:composition>
