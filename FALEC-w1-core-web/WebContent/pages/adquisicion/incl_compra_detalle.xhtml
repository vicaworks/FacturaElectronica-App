<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions">
	
	<style type="text/css">
		
		/* .adquisicionDetDT .ui-datatable-scrollable-body{
				min-height: 46vh !important;
				
		} */
		
		.ui-datascroller .ui-datascroller-content {/* min-height:500px!important; */height: calc(100vh - 345px);}
		
	</style>
	
	<p:remoteCommand name="establecerFocoDetalle" action="#{adquisicionFrmCtrl.establecerFocoDetalle}" update=":formMain:adquisicionDetDT"/>
	
	<div class="card card-w-title">
		<div class="flex flex-inline py-1">
			<p:commandButton id="cmdAdqBuscarProducto"
				title="Buscar Producto" icon="fa fa-search" 
				action="#{listaProductoCtrl.cargarPantalla()}"  update="@form" process="@form @this :formMain:adquisicionDetDT" styleClass="mr-1">
				<f:setPropertyActionListener value="#{adquisicionFrmCtrl}" target="#{listaProductoCtrl.adquisicionFrmCtrl}"/>
				<f:setPropertyActionListener value="#{adquisicionFrmCtrl.establecimientoMain}" target="#{listaProductoCtrl.establecimientoMain}"/>
				<f:setPropertyActionListener value="ADQUISICION" target="#{listaProductoCtrl.callModule}"/>
				<f:setPropertyActionListener value=":formMain:adquisicionDetDT :formMain:oupTotales :formMain:oupPagoDT" target="#{listaProductoCtrl.viewUpdate}"/>
				<f:setPropertyActionListener value="formMain" target="#{listaProductoCtrl.formModule}"/>
			</p:commandButton>
			
			<p:commandButton  id="cmdAdqAgregarDetalle" 
				icon="fa fa-plus"
				value="ITEM"
				styleClass="ui-button-outlined mr-1"
				action="#{adquisicionFrmCtrl.agregarDetalle()}"
				process="@this :formMain:adquisicionDetDT"
				update="@form">
			</p:commandButton>
			
			<p:commandButton  id="cmdAdqAgregarProducto" 
				icon="fa fa-file-o"
				title="Nuevo producto"
				styleClass="ui-button-outlined"
				action="#{productoCtrl.nuevo()}"
				update="@form" 
				process="@this :formMain:adquisicionDetDT">
				<f:setPropertyActionListener value="ADQUISICION" target="#{productoCtrl.callModule}"/>
				<f:setPropertyActionListener value="#{adquisicionFrmCtrl.establecimientoMain}" target="#{productoCtrl.establecimientoMain}"/>
				<f:setPropertyActionListener value="formMain" target="#{productoCtrl.formModule}"/>
				<f:setPropertyActionListener value=":formMain:adquisicionDetDT :formMain:oupTotales :formMain:oupPagoDT" target="#{productoCtrl.viewUpdate}"/>
				<f:setPropertyActionListener value="#{adquisicionFrmCtrl}" target="#{productoCtrl.adquisicionFrmCtrl}"/>
			</p:commandButton>
		</div>
		
		
			
		<p:dataScroller id="adquisicionDetDT" value="#{adquisicionFrmCtrl.adquisiciondetalleList}" var="d" chunkSize="10" mode="inline" styleClass="adquisicionDetDT" >
            <f:facet name="header">
            	<i class="fa fa-list mr-1"></i>
                Lista
            </f:facet>
            
           </p:dataScroller>
		<!-- subtotales -->
		<p:outputPanel id="oupTotales" styleClass="w-full">
			<div class="grid">
				<div class="col-12 md:col-7">
					<div class="grid grid-nogutter justify-content-between">
						<div class="col-8 py-1">
							<div class="w-full">
								<span class="Fs10 mr-1 text-gray-700 font-semibold">RESUMEN</span>
								<span class="Fs14 text-blue-600 font-medium">TOTALES</span>
							</div>
						</div>
						<div class="col-1 text-center align-self-center">
							<i class="fa fa-angle-down Fs14"></i>
						</div>
						<div class="col-12 mt-1">
							
							<div class="flex mt-1 border-bottom-1 border-blue-100 py-1">
								<div class="flex flex-grow-1 Fs9">
									<i class="fa fa-angle-right mr-1 font-bold"></i>
									<span class="text-gray-800">SUBTOTAL</span>
								</div>						
								<div class="flex flex-grow-1">
									<div class="text-right pr-3 w-full">
										<h:outputText value="#{adquisicionFrmCtrl.adquisicionSelected.subtotal}" styleClass="Fs14 text-gray-600 font-medium">
						   					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						   				</h:outputText>
									</div>
								</div>				
							</div>
							
							<div class="flex mt-1 border-bottom-1 border-blue-100 py-1">
								<div class="flex flex-grow-1 Fs9">
									<i class="fa fa-angle-right mr-1 font-bold"></i>
									<span class="text-gray-800">DESCUENTO</span>
								</div>						
								<div class="flex flex-grow-1">
									<div class="text-right pr-3 w-full">
										<h:outputText value="#{adquisicionFrmCtrl.adquisicionSelected.totaldescuento}" styleClass="Fs14 text-gray-600 font-medium">
						   					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						   				</h:outputText>
									</div>
								</div>				
							</div>
							
							<div class="flex mt-1 border-bottom-1 border-blue-100 py-1">
								<div class="flex flex-grow-1 Fs9">
									<i class="fa fa-angle-right mr-1 font-bold"></i>
									<span class="text-gray-800">I.C.E.</span>
								</div>						
								<div class="flex flex-grow-1">
									<div class="text-right pr-3 w-full">
										<h:outputText value="#{adquisicionFrmCtrl.adquisicionSelected.totalice}" styleClass="Fs14 text-gray-600 font-medium">
						   					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						   				</h:outputText>
									</div>
								</div>				
							</div>
							
							<div class="flex mt-1 border-bottom-1 border-blue-100 py-1">
								<div class="flex flex-grow-1 Fs9">
									<i class="fa fa-angle-right mr-1 font-bold"></i>
									<span class="text-gray-800">I.V.A.</span>
								</div>						
								<div class="flex flex-grow-1">
									<div class="text-right pr-3 w-full">
										<h:outputText value="#{adquisicionFrmCtrl.adquisicionSelected.totaliva}" styleClass="Fs14 text-gray-600 font-medium">
						   					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						   				</h:outputText>
									</div>
								</div>				
							</div>
								
						</div>
					</div>
				</div>
				<div class="col-12 md:col-5 align-self-center text-center py-2">
					<h:outputText value="#{adquisicionFrmCtrl.adquisicionSelected.totalfactura}" styleClass="Fs24 text-gray-600 font-bold">
						<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
					</h:outputText>
				</div>
			</div>
		</p:outputPanel>
	</div>
			
</ui:composition>
