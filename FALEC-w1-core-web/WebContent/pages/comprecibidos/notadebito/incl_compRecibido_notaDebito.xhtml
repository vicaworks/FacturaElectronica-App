<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
				xmlns:of="http://omnifaces.org/functions"
				xmlns:pe="http://primefaces.org/ui/extensions">
	
    <style type="text/css">
    	
    	.compNDSriDT .ui-datatable-scrollable-body{
			min-height: 35vh !important;
			height: calc(100vh - 465px)!important;
		}
    	
    </style>
    
	<div class="card card-w-title">
		<h3 class="cardTitle"><i class="fa fa-arrow-circle-right" /> Notas de Débito</h3>
		<div class="EmptyBox5" />
		<div class="p-grid p-align-top vertical-container">
			<div class="p-col-12 p-md-3">
    			<h:outputText value="Desde" styleClass="FontBold DispBlock" style="margin-bottom:5px;"/>
	    		<p:calendar id="calDesde" value="#{compRecNotaDebitoCtrl.desde}" 
					pattern="dd/MM/yyyy"
					locale="es" 
					requiredMessage="REQUERIDO" required="true" styleClass="Wid100" placeholder="dd/MM/yyyy">
				</p:calendar>
				<p:message for="calDesde"/>
    		</div>
    		
    		<div class="p-col-12 p-md-3">
    			<h:outputText value="Hasta" styleClass="FontBold DispBlock" style="margin-bottom:5px;"/>
	    		<p:calendar id="calHasta" value="#{compRecNotaDebitoCtrl.hasta}"
					pattern="dd/MM/yyyy"
					locale="es" 
					requiredMessage="REQUERIDO" required="true" styleClass="Wid100" placeholder="dd/MM/yyyy">
				</p:calendar>
				<p:message for="calHasta"/>
    		</div>
    		<div class="p-col-12 p-md-3">
    			<div style="margin-bottom: 1px;">
	    			<p:selectBooleanCheckbox value="#{compRecNotaDebitoCtrl.aplicarFechas}"/><h:outputText value=" Aplicar fechas criterio de búsqueda" styleClass="FontBold"/>
				</div>
    			<p:inputText value="#{compRecNotaDebitoCtrl.criterioBusqueda}" placeholder="# Factura, R.U.C., Emisor" styleClass="Wid100"/>
    		</div>
    		<div class="p-col-12 p-lg-3">
    			<p:commandButton 
							icon="fa fa-search"
							action="#{compRecNotaDebitoCtrl.buscar()}" styleClass="secondary-button Wid100" update="@form" style="margin-right:5px;" value="BUSCAR"/>
				<div class="EmptyBox5"/>
				<p:commandButton id="cmdGlobalExcel"
	  						value="EXPORTAR"
							icon="fa fa-sort-down" 
							styleClass="secondary-button Wid100"
							disabled="#{empty compRecNotaDebitoCtrl.comprobanteRecibidoList}" ajax="false">
							<p:fileDownload value="#{compRecNotaDebitoCtrl.fileResumen}" contentDisposition="inline"/>
				</p:commandButton>
				
				<!-- <p:menu overlay="true" trigger="cmdGlobalExcel" my="left top" at="left bottom" style="width:250px !important;">
					<p:menuitem value="Exportar excel" icon="fa fa-file-excel-o" ajax="false">
						<p:fileDownload value="#{compRecNotaDebitoCtrl.fileResumen}" contentDisposition="inline"/>
					</p:menuitem>
					<p:menuitem value="Exportar excel(detalle)" icon="fa fa-list" ajax="false">
						<p:fileDownload value="#{null}" contentDisposition="inline"/>
					</p:menuitem>
				</p:menu> -->
    		</div>
		</div>
	</div>
	
	<div class="EmptyBox5"/>
	<div class="card card-w-title">
		
		<div class="p-grid p-nogutter p-justify-around">
			<div class="p-col-4 p-lg-3">
				
				<div class="cardContador cardContador-borderOrange">
					<div class="cardContador-header">
						<h:outputText value="SUBTOTAL" />
					</div>
					<div class="cardContador-content">
						<h:outputText value="#{compRecNotaDebitoCtrl.comprobanteRecibidoTotal.totalsinimpuestos}" >
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</div>
				
			</div>
			
			<div class="p-col-4 p-lg-3">
				
				<div class="cardContador cardContador-borderBlack">
					<div class="cardContador-header">
						<h:outputText value="IVA" />
					</div>
					<div class="cardContador-content">
						<h:outputText value="#{compRecNotaDebitoCtrl.comprobanteRecibidoTotal.totaliva}" >
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</div>
				
			</div>
			
			<div class="p-col-4 p-lg-3">
				
				<div class="cardContador cardContador-bgBlack">
					<div class="cardContador-header">
						<h:outputText value="TOTAL" />
					</div>
					<div class="cardContador-content">
						<h:outputText value="#{compRecNotaDebitoCtrl.comprobanteRecibidoTotal.totalconimpuestos}" >
							<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
						</h:outputText>
					</div>
				</div>
				
			</div>
			
		</div>
		<div class="EmptyBox5"/>
		<div class="p-grid p-justify-start p-align-center">
			<p:spacer width="10px"/>
			<i class="fa fa-ellipsis-v fa-lg"/>
			<p:spacer width="10px"/>
			<p:commandButton disabled="#{empty compRecNotaDebitoCtrl.comprobanteRecibidoList}" ajax="false" onclick="PrimeFaces.monitorDownload(start,stop)" value="Descargar selección" icon="fa fa-download" styleClass="secondary-button Fs10">
				<p:fileDownload value="#{compRecNotaDebitoCtrl.descargarSeleccion}" contentDisposition="inline"/>
			</p:commandButton>
		</div>
		<div class="EmptyBox5"/>
		<p:dataTable id="compNDSriDT" var="nd"
						value="#{compRecNotaDebitoCtrl.comprobanteRecibidoList}" 
						scrollable="true"
						emptyMessage="#{msg['mensaje.noexistenDatos']}"
						styleClass="compNDSriDT Fs11"  
						rowKey="#{nd.idcomprobanterecibido}"
						rows="30"
		                paginator="true"
		                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
		                currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
		                paginatorPosition="bottom"  
						rowsPerPageTemplate="10,15,20,25,30,35,40"
						selection="#{compRecNotaDebitoCtrl.comprobanteRecibidoSeleccionList}">
		    
		    <p:ajax  event="toggleSelect" listener="#{compRecNotaDebitoCtrl.selectAllComprobantesRecibidos}" update=":formMain:fsvNotaDebito:compNDSriDT"/>
		    
		    <p:column selectionMode="multiple" style="text-align: center;width:10px" />
		    
		    <p:column headerText="OPC" style="width:20px;" styleClass="TexAlCenter">
		    	<p:commandLink id="cmlDtFacEmitidas">
					<i class="fa fa-chevron-circle-down Fs18" style="color:#252529;"/>
				</p:commandLink>
				
				<p:menu overlay="true" trigger="cmlDtFacEmitidas" my="left top" at="left bottom">
					<p:menuitem value="RIDE" action="#{compRecNotaDebitoCtrl.showRide()}" icon="fa fa-file-pdf-o">
						<f:setPropertyActionListener value="#{nd}" target="#{compRecNotaDebitoCtrl.comprobanteRecibidoSelected}"/>
						<f:setPropertyActionListener value="#{rideCtrl}" target="#{compRecNotaDebitoCtrl.rideCtrl}"/>
					</p:menuitem>
					<p:menuitem value="Ver XML formato" icon="fa fa-eye" oncomplete="PF('dlgCRImportXml').show();" update=":formCRXml" action="#{compRecibidosCtrl.formatoValorXml()}">
						<f:setPropertyActionListener value="#{nd}" target="#{compRecibidosCtrl.comprobanteRecibidoSelected}"/>
						<f:setPropertyActionListener value="#{nd.valorXml}" target="#{compRecibidosCtrl.xml}"/>
						<f:setPropertyActionListener value="#{true}" target="#{compRecibidosCtrl.formatoXml}"/>
					</p:menuitem>
					
					<p:menuitem value="Ver XML original" icon="fa fa-eye" oncomplete="PF('dlgCRImportXml').show();" update=":formCRXml" action="#{compRecibidosCtrl.formatoValorXml()}">
						<f:setPropertyActionListener value="#{nd}" target="#{compRecibidosCtrl.comprobanteRecibidoSelected}"/>
						<f:setPropertyActionListener value="#{nd.valorXml}" target="#{compRecibidosCtrl.xml}"/>
						<f:setPropertyActionListener value="#{false}" target="#{compRecibidosCtrl.formatoXml}"/>
					</p:menuitem>
				</p:menu>	
		    </p:column>    
		    
		    <p:column headerText="COMPROBANTE" style="width:90px;">
				<h:outputText value="#{facEmitidaCtrl.getFormatoNumDocumento(nd.serieComprobante)}" />
			</p:column>
			
			<p:column headerText="FECHA #{msg['label.emision']}" style="width:40px;">
				<h:outputText value="#{nd.fechaEmision}" >
					<f:convertDateTime pattern="dd/MM/yyyy"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="FECHA AUTOR." style="width:40px;">
				<h:outputText value="#{nd.fechaAutorizacion}" >
					<f:convertDateTime pattern="dd/MM/yyyy"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="RUC / CI EMISOR" style="width:90px;" filterBy="#{nd.rucEmisor}" filterMatchMode="contains">
				<h:outputText value="#{nd.rucEmisor}" />
			</p:column>
			
			<p:column headerText="EMISOR" style="width:200px;" filterBy="#{nd.razonSocialEmisor}" filterMatchMode="contains">
				<h:outputText value="#{nd.razonSocialEmisor}" >
				</h:outputText>
			</p:column>
					
			<p:column headerText="SUBTOT" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{nd.totalsinimpuestos}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="IVA" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{nd.totaliva}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
			
			<p:column headerText="TOTAL" style="width:40px;" styleClass="TexAlRight">
				<h:outputText value="#{nd.totalconimpuestos}" >
					<f:convertNumber pattern="#{appSessionCtrl.formatoMoneda}"/>
				</h:outputText>
			</p:column>
		
		</p:dataTable>
		
		<div class="EmptyBox20"/>
	
	</div>
	
	<div class="EmptyBox30"/>

</ui:composition>
